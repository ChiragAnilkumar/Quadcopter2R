function S = eom_quad(t,s)

% Desired set of generalized coordinates
% Pick Up
zeta_des =[0;0;0;0;0;0;pi/2;0]; 
% Move
% zeta_des =[1;0;1;0;0;0;pi/2;0];
%Drop
% zeta_des =[1;0;1;0;0;0;pi/2;-pi/4];

% Simulation paramters for the system

% Pick
l = 0.1;
mb = 0.8;
m = 0.1;
g = 9.81;
d = 0.1;

% Move
% l = 0.1;
% mb = 0.8;
% m = 0.1+0.1; % Picked up mass is considered as extra mass of the link
% g = 9.81;
% d = 0.1;

%Drop
% l = 0.1;
% mb = 0.8;
% m = 0.1+0.1;
% g = 9.81;
% d = 0.1;

% Inertia matrix of quadcopter
I = ((mb*l^2)/12)*[1,0,0;0,1,0;0,0,2];
% Inertia matrix of 2R manipulator
H = ((m*d^2)/3)*[0 0 0;0 1 0;0 0 0];

% State space representation
x = s(1);
y = s(2);
z = s(3);
xdot = s(4);
ydot = s(5);
zdot = s(6);
psi = s(7);
theta = s(8);
phi = s(9);
phidot = s(10);
thetadot = s(11);
psidot = s(12);
q1 = s(13);
q2 = s(14);
q1dot = s(15);
q2dot = s(16);

% Rotation matrix
R = [cos(psi)*cos(theta), cos(psi)*sin(theta)*sin(phi)-sin(psi)*cos(phi), cos(psi)*sin(theta)*cos(phi)+sin(psi)*sin(phi);
    sin(psi)*cos(theta), sin(psi)*sin(theta)*sin(phi)+cos(psi)*cos(phi), sin(psi)*sin(theta)*cos(phi)-cos(psi)*sin(phi);
    -sin(theta), cos(theta)*sin(phi), cos(theta)*cos(phi)];
% Transformation matrix
T = [0,-sin(psi),cos(psi)*cos(theta);
    0, cos(psi),sin(psi)*cos(theta);
    1, 0,-sin(theta)];

zeta = [x;y;z;psi;theta;phi;q1;q2];
zetadot=[xdot;ydot;zdot;psidot;thetadot;phidot;q1dot;q2dot];

P2 = [l*cos(q1)+l*cos(q1+q2);
      0;
     -(l*sin(q1)+l*sin(q1+q2))];
P1 = [l*cos(q1);0;-l*sin(q1)];
M1 = R*P1;
M2 = R*P2;

S1 =[0 -M1(3) M1(2) ; M1(3) 0 -M1(1) ; -M1(2) M1(1) 0 ];
S2 =[0 -M2(3) M2(2) ; M2(3) 0 -M2(1) ; -M2(2) M2(1) 0 ];

Jv1 = [-l*sin(q1), 0 ;0, 0;-l*cos(q1), 0];
Jv2 = [-l*sin(q1)-l*sin(q1+q2), -l*sin(q1+q2);0, 0;-(l*cos(q1)+l*cos(q1+q2)), -l*cos(q1+q2)];
Jw1 = [0, 0; 1, 0;0, 0];
Jw2 = [0, 0; 1, 1;0, 0];
R1 = [cos(q1), 0, sin(q1);0, 1, 0;-sin(q1), 0, cos(q1)];
R2 = [cos(q1+q2), 0, sin(q1+q2); 0, 1, 0;-sin(q1+q2), 0, cos(q1+q2)];

I3 = [1 0 0;0 1 0;0 0 1];
O33 = [0 0 0;0 0 0;0 0 0];
O32 = [0 0;0 0;0 0];
Mtb = ([I3 O33 O32]);
Mrb = [O33 T O32];
Mt1 = [I3 -(S1)*T R*Jv1];
Mt2 = [I3 -(S2)*T R*Jv2];
Mr1 = [O33 T R*Jw1];
Mr2 = [O33 T R*Jw2];

% Inertia matrix
M = Mtb'*mb*Mtb + Mrb'*R*I*R'*Mrb + Mt1'*m*Mt1 + Mr1'*(R*R1)*H*(R*R1)'*Mr1 ...
    +Mt2'*m*Mt2 + Mr2'*(R*R2)*H*(R*R2)'*Mr2;

% Coriolis matrix
C = [
     0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (l*m*(2*q1dot*sin(q1 + q2)*cos(theta)*sin(psi) - phidot*sin(q1 + q2)*cos(phi)*cos(psi) - 2*q1dot*cos(q1 + q2)*cos(psi)*sin(phi) - 2*q2dot*cos(q1 + q2)*cos(psi)*sin(phi) - 2*psidot*cos(q1 + q2)*cos(psi)*cos(theta) + 2*q2dot*sin(q1 + q2)*cos(theta)*sin(psi) + 2*thetadot*cos(q1 + q2)*sin(psi)*sin(theta) + 2*psidot*sin(q1 + q2)*sin(phi)*sin(psi) - 4*psidot*cos(psi)*cos(q1)*cos(theta) - 2*phidot*cos(phi)*cos(psi)*sin(q1) - 4*q1dot*cos(psi)*cos(q1)*sin(phi) + 4*q1dot*cos(theta)*sin(psi)*sin(q1) + 4*thetadot*cos(q1)*sin(psi)*sin(theta) + 4*psidot*sin(phi)*sin(psi)*sin(q1) + 2*psidot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*q1dot*cos(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 2*q2dot*cos(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 2*thetadot*sin(q1 + q2)*cos(phi)*cos(theta)*sin(psi) - 2*phidot*sin(q1 + q2)*sin(phi)*sin(psi)*sin(theta) + 4*psidot*cos(phi)*cos(psi)*sin(q1)*sin(theta) + 4*q1dot*cos(phi)*cos(q1)*sin(psi)*sin(theta) + 4*thetadot*cos(phi)*cos(theta)*sin(psi)*sin(q1) - phidot*sin(q1 + q2)*cos(phi)*cos(psi)*cos(theta)^2 - 4*phidot*sin(phi)*sin(psi)*sin(q1)*sin(theta) - phidot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta)^2 - 2*phidot*cos(phi)*cos(psi)*cos(theta)^2*sin(q1) - 2*phidot*cos(phi)*cos(psi)*sin(q1)*sin(theta)^2))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              l*m*(2*psidot*cos(q1)*sin(psi)*sin(theta) - 2*thetadot*cos(psi)*cos(q1)*cos(theta) + 2*q1dot*cos(psi)*sin(q1)*sin(theta) - 2*q1dot*cos(phi)*cos(psi)*cos(q1)*cos(theta) - thetadot*cos(psi)*cos(q1)*cos(q2)*cos(theta) + 2*phidot*cos(psi)*cos(theta)*sin(phi)*sin(q1) + 2*psidot*cos(phi)*cos(theta)*sin(psi)*sin(q1) + psidot*cos(q1)*cos(q2)*sin(psi)*sin(theta) + q1dot*cos(psi)*cos(q1)*sin(q2)*sin(theta) + q1dot*cos(psi)*cos(q2)*sin(q1)*sin(theta) + q2dot*cos(psi)*cos(q1)*sin(q2)*sin(theta) + q2dot*cos(psi)*cos(q2)*sin(q1)*sin(theta) + 2*thetadot*cos(phi)*cos(psi)*sin(q1)*sin(theta) + thetadot*cos(psi)*cos(theta)*sin(q1)*sin(q2) - psidot*sin(psi)*sin(q1)*sin(q2)*sin(theta) + phidot*cos(psi)*cos(q1)*cos(theta)*sin(phi)*sin(q2) + phidot*cos(psi)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + psidot*cos(phi)*cos(q1)*cos(theta)*sin(psi)*sin(q2) + psidot*cos(phi)*cos(q2)*cos(theta)*sin(psi)*sin(q1) + q1dot*cos(phi)*cos(psi)*cos(theta)*sin(q1)*sin(q2) + q2dot*cos(phi)*cos(psi)*cos(theta)*sin(q1)*sin(q2) + thetadot*cos(phi)*cos(psi)*cos(q1)*sin(q2)*sin(theta) + thetadot*cos(phi)*cos(psi)*cos(q2)*sin(q1)*sin(theta) - q1dot*cos(phi)*cos(psi)*cos(q1)*cos(q2)*cos(theta) - q2dot*cos(phi)*cos(psi)*cos(q1)*cos(q2)*cos(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         l*m*(2*phidot*sin(phi)*sin(psi)*sin(q1) - 2*q1dot*cos(phi)*cos(q1)*sin(psi) - 2*psidot*cos(phi)*cos(psi)*sin(q1) - psidot*cos(phi)*cos(psi)*cos(q1)*sin(q2) - psidot*cos(phi)*cos(psi)*cos(q2)*sin(q1) - q1dot*cos(phi)*cos(q1)*cos(q2)*sin(psi) - q2dot*cos(phi)*cos(q1)*cos(q2)*sin(psi) + 2*phidot*cos(phi)*cos(psi)*sin(q1)*sin(theta) + 2*q1dot*cos(psi)*cos(q1)*sin(phi)*sin(theta) + 2*thetadot*cos(psi)*cos(theta)*sin(phi)*sin(q1) + phidot*cos(q1)*sin(phi)*sin(psi)*sin(q2) + phidot*cos(q2)*sin(phi)*sin(psi)*sin(q1) + q1dot*cos(phi)*sin(psi)*sin(q1)*sin(q2) + q2dot*cos(phi)*sin(psi)*sin(q1)*sin(q2) - 2*psidot*sin(phi)*sin(psi)*sin(q1)*sin(theta) + phidot*cos(phi)*cos(psi)*cos(q1)*sin(q2)*sin(theta) + phidot*cos(phi)*cos(psi)*cos(q2)*sin(q1)*sin(theta) + q1dot*cos(psi)*cos(q1)*cos(q2)*sin(phi)*sin(theta) + q2dot*cos(psi)*cos(q1)*cos(q2)*sin(phi)*sin(theta) + thetadot*cos(psi)*cos(q1)*cos(theta)*sin(phi)*sin(q2) + thetadot*cos(psi)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - psidot*cos(q1)*sin(phi)*sin(psi)*sin(q2)*sin(theta) - psidot*cos(q2)*sin(phi)*sin(psi)*sin(q1)*sin(theta) - q1dot*cos(psi)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - q2dot*cos(psi)*sin(phi)*sin(q1)*sin(q2)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (l*m*(2*psidot*sin(q1 + q2)*cos(theta)*sin(psi) - 2*q2dot*cos(q1 + q2)*cos(psi)*cos(theta) - phidot*cos(q1 + q2)*cos(phi)*sin(psi) - 2*psidot*cos(q1 + q2)*cos(psi)*sin(phi) - 2*q1dot*cos(q1 + q2)*cos(psi)*cos(theta) + 2*thetadot*sin(q1 + q2)*cos(psi)*sin(theta) + 2*q1dot*sin(q1 + q2)*sin(phi)*sin(psi) + 2*q2dot*sin(q1 + q2)*sin(phi)*sin(psi) - 4*q1dot*cos(psi)*cos(q1)*cos(theta) - 2*phidot*cos(phi)*cos(q1)*sin(psi) - 4*psidot*cos(psi)*cos(q1)*sin(phi) + 4*psidot*cos(theta)*sin(psi)*sin(q1) + 4*thetadot*cos(psi)*sin(q1)*sin(theta) + 4*q1dot*sin(phi)*sin(psi)*sin(q1) + 2*phidot*cos(q1 + q2)*cos(psi)*sin(phi)*sin(theta) + 2*psidot*cos(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 2*q1dot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*q2dot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta) - 4*thetadot*cos(phi)*cos(psi)*cos(q1)*cos(theta) + 4*phidot*cos(psi)*cos(q1)*sin(phi)*sin(theta) + 4*psidot*cos(phi)*cos(q1)*sin(psi)*sin(theta) + 4*q1dot*cos(phi)*cos(psi)*sin(q1)*sin(theta) - phidot*cos(q1 + q2)*cos(phi)*cos(theta)^2*sin(psi) - phidot*cos(q1 + q2)*cos(phi)*sin(psi)*sin(theta)^2 - 2*phidot*cos(phi)*cos(q1)*cos(theta)^2*sin(psi) - 2*phidot*cos(phi)*cos(q1)*sin(psi)*sin(theta)^2 - 2*thetadot*cos(q1 + q2)*cos(phi)*cos(psi)*cos(theta)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (l*m*(2*psidot*sin(q1 + q2)*cos(theta)*sin(psi) - 2*q2dot*cos(q1 + q2)*cos(psi)*cos(theta) - 2*phidot*cos(q1 + q2)*cos(phi)*sin(psi) - 2*psidot*cos(q1 + q2)*cos(psi)*sin(phi) - 2*q1dot*cos(q1 + q2)*cos(psi)*cos(theta) + 2*thetadot*sin(q1 + q2)*cos(psi)*sin(theta) + 2*q1dot*sin(q1 + q2)*sin(phi)*sin(psi) + 2*q2dot*sin(q1 + q2)*sin(phi)*sin(psi) + 2*phidot*cos(q1 + q2)*cos(psi)*sin(phi)*sin(theta) + 2*psidot*cos(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 2*q1dot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*q2dot*sin(q1 + q2)*cos(phi)*cos(psi)*sin(theta) - 2*thetadot*cos(q1 + q2)*cos(phi)*cos(psi)*cos(theta)))/2;
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -(l*m*(2*psidot*cos(q1 + q2)*cos(theta)*sin(psi) + 2*q1dot*sin(q1 + q2)*cos(psi)*cos(theta) + 2*q2dot*sin(q1 + q2)*cos(psi)*cos(theta) + 2*thetadot*cos(q1 + q2)*cos(psi)*sin(theta) + phidot*sin(q1 + q2)*cos(phi)*sin(psi) + 2*psidot*sin(q1 + q2)*cos(psi)*sin(phi) + 2*q1dot*cos(q1 + q2)*sin(phi)*sin(psi) + 2*q2dot*cos(q1 + q2)*sin(phi)*sin(psi) + 4*psidot*cos(q1)*cos(theta)*sin(psi) + 4*q1dot*cos(psi)*cos(theta)*sin(q1) + 4*thetadot*cos(psi)*cos(q1)*sin(theta) + 2*phidot*cos(phi)*sin(psi)*sin(q1) + 4*psidot*cos(psi)*sin(phi)*sin(q1) + 4*q1dot*cos(q1)*sin(phi)*sin(psi) + 2*q1dot*cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*q2dot*cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*thetadot*sin(q1 + q2)*cos(phi)*cos(psi)*cos(theta) - 2*phidot*sin(q1 + q2)*cos(psi)*sin(phi)*sin(theta) - 2*psidot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 4*q1dot*cos(phi)*cos(psi)*cos(q1)*sin(theta) + 4*thetadot*cos(phi)*cos(psi)*cos(theta)*sin(q1) - 4*phidot*cos(psi)*sin(phi)*sin(q1)*sin(theta) - 4*psidot*cos(phi)*sin(psi)*sin(q1)*sin(theta) + phidot*sin(q1 + q2)*cos(phi)*cos(theta)^2*sin(psi) + phidot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta)^2 + 2*phidot*cos(phi)*cos(theta)^2*sin(psi)*sin(q1) + 2*phidot*cos(phi)*sin(psi)*sin(q1)*sin(theta)^2))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              l*m*(2*q1dot*sin(psi)*sin(q1)*sin(theta) - 2*thetadot*cos(q1)*cos(theta)*sin(psi) - 2*psidot*cos(psi)*cos(q1)*sin(theta) - 2*psidot*cos(phi)*cos(psi)*cos(theta)*sin(q1) - 2*q1dot*cos(phi)*cos(q1)*cos(theta)*sin(psi) - psidot*cos(psi)*cos(q1)*cos(q2)*sin(theta) - thetadot*cos(q1)*cos(q2)*cos(theta)*sin(psi) + 2*phidot*cos(theta)*sin(phi)*sin(psi)*sin(q1) + psidot*cos(psi)*sin(q1)*sin(q2)*sin(theta) + q1dot*cos(q1)*sin(psi)*sin(q2)*sin(theta) + q1dot*cos(q2)*sin(psi)*sin(q1)*sin(theta) + q2dot*cos(q1)*sin(psi)*sin(q2)*sin(theta) + q2dot*cos(q2)*sin(psi)*sin(q1)*sin(theta) + 2*thetadot*cos(phi)*sin(psi)*sin(q1)*sin(theta) + thetadot*cos(theta)*sin(psi)*sin(q1)*sin(q2) - psidot*cos(phi)*cos(psi)*cos(q1)*cos(theta)*sin(q2) - psidot*cos(phi)*cos(psi)*cos(q2)*cos(theta)*sin(q1) - q1dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(psi) - q2dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(psi) + phidot*cos(q1)*cos(theta)*sin(phi)*sin(psi)*sin(q2) + phidot*cos(q2)*cos(theta)*sin(phi)*sin(psi)*sin(q1) + q1dot*cos(phi)*cos(theta)*sin(psi)*sin(q1)*sin(q2) + q2dot*cos(phi)*cos(theta)*sin(psi)*sin(q1)*sin(q2) + thetadot*cos(phi)*cos(q1)*sin(psi)*sin(q2)*sin(theta) + thetadot*cos(phi)*cos(q2)*sin(psi)*sin(q1)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         l*m*(2*q1dot*cos(phi)*cos(psi)*cos(q1) - 2*phidot*cos(psi)*sin(phi)*sin(q1) - 2*psidot*cos(phi)*sin(psi)*sin(q1) + q1dot*cos(phi)*cos(psi)*cos(q1)*cos(q2) + q2dot*cos(phi)*cos(psi)*cos(q1)*cos(q2) - phidot*cos(psi)*cos(q1)*sin(phi)*sin(q2) - phidot*cos(psi)*cos(q2)*sin(phi)*sin(q1) - psidot*cos(phi)*cos(q1)*sin(psi)*sin(q2) - psidot*cos(phi)*cos(q2)*sin(psi)*sin(q1) - q1dot*cos(phi)*cos(psi)*sin(q1)*sin(q2) - q2dot*cos(phi)*cos(psi)*sin(q1)*sin(q2) + 2*phidot*cos(phi)*sin(psi)*sin(q1)*sin(theta) + 2*psidot*cos(psi)*sin(phi)*sin(q1)*sin(theta) + 2*q1dot*cos(q1)*sin(phi)*sin(psi)*sin(theta) + 2*thetadot*cos(theta)*sin(phi)*sin(psi)*sin(q1) + phidot*cos(phi)*cos(q1)*sin(psi)*sin(q2)*sin(theta) + phidot*cos(phi)*cos(q2)*sin(psi)*sin(q1)*sin(theta) + psidot*cos(psi)*cos(q1)*sin(phi)*sin(q2)*sin(theta) + psidot*cos(psi)*cos(q2)*sin(phi)*sin(q1)*sin(theta) + q1dot*cos(q1)*cos(q2)*sin(phi)*sin(psi)*sin(theta) + q2dot*cos(q1)*cos(q2)*sin(phi)*sin(psi)*sin(theta) + thetadot*cos(q1)*cos(theta)*sin(phi)*sin(psi)*sin(q2) + thetadot*cos(q2)*cos(theta)*sin(phi)*sin(psi)*sin(q1) - q1dot*sin(phi)*sin(psi)*sin(q1)*sin(q2)*sin(theta) - q2dot*sin(phi)*sin(psi)*sin(q1)*sin(q2)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             -(l*m*(2*psidot*sin(q1 + q2)*cos(psi)*cos(theta) - phidot*cos(q1 + q2)*cos(phi)*cos(psi) + 2*q1dot*cos(q1 + q2)*cos(theta)*sin(psi) + 2*q2dot*cos(q1 + q2)*cos(theta)*sin(psi) + 2*psidot*cos(q1 + q2)*sin(phi)*sin(psi) + 2*q1dot*sin(q1 + q2)*cos(psi)*sin(phi) + 2*q2dot*sin(q1 + q2)*cos(psi)*sin(phi) - 2*phidot*cos(phi)*cos(psi)*cos(q1) - 2*thetadot*sin(q1 + q2)*sin(psi)*sin(theta) + 4*psidot*cos(psi)*cos(theta)*sin(q1) + 4*q1dot*cos(q1)*cos(theta)*sin(psi) + 4*psidot*cos(q1)*sin(phi)*sin(psi) + 4*q1dot*cos(psi)*sin(phi)*sin(q1) - 4*thetadot*sin(psi)*sin(q1)*sin(theta) + 2*psidot*cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*thetadot*cos(q1 + q2)*cos(phi)*cos(theta)*sin(psi) - 2*phidot*cos(q1 + q2)*sin(phi)*sin(psi)*sin(theta) - 2*q1dot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta) - 2*q2dot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta) + 4*psidot*cos(phi)*cos(psi)*cos(q1)*sin(theta) + 4*thetadot*cos(phi)*cos(q1)*cos(theta)*sin(psi) - phidot*cos(q1 + q2)*cos(phi)*cos(psi)*cos(theta)^2 - 4*phidot*cos(q1)*sin(phi)*sin(psi)*sin(theta) - 4*q1dot*cos(phi)*sin(psi)*sin(q1)*sin(theta) - phidot*cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta)^2 - 2*phidot*cos(phi)*cos(psi)*cos(q1)*cos(theta)^2 - 2*phidot*cos(phi)*cos(psi)*cos(q1)*sin(theta)^2))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             -(l*m*(2*psidot*sin(q1 + q2)*cos(psi)*cos(theta) - 2*phidot*cos(q1 + q2)*cos(phi)*cos(psi) + 2*q1dot*cos(q1 + q2)*cos(theta)*sin(psi) + 2*q2dot*cos(q1 + q2)*cos(theta)*sin(psi) + 2*psidot*cos(q1 + q2)*sin(phi)*sin(psi) + 2*q1dot*sin(q1 + q2)*cos(psi)*sin(phi) + 2*q2dot*sin(q1 + q2)*cos(psi)*sin(phi) - 2*thetadot*sin(q1 + q2)*sin(psi)*sin(theta) + 2*psidot*cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta) + 2*thetadot*cos(q1 + q2)*cos(phi)*cos(theta)*sin(psi) - 2*phidot*cos(q1 + q2)*sin(phi)*sin(psi)*sin(theta) - 2*q1dot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta) - 2*q2dot*sin(q1 + q2)*cos(phi)*sin(psi)*sin(theta)))/2;
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      l*m*(2*q1dot*cos(theta)*sin(q1) + 2*thetadot*cos(q1)*sin(theta) + 2*q1dot*cos(phi)*cos(q1)*sin(theta) + q1dot*cos(q1)*cos(theta)*sin(q2) + q1dot*cos(q2)*cos(theta)*sin(q1) + q2dot*cos(q1)*cos(theta)*sin(q2) + q2dot*cos(q2)*cos(theta)*sin(q1) + 2*thetadot*cos(phi)*cos(theta)*sin(q1) + thetadot*cos(q1)*cos(q2)*sin(theta) - 2*phidot*sin(phi)*sin(q1)*sin(theta) - thetadot*sin(q1)*sin(q2)*sin(theta) + q1dot*cos(phi)*cos(q1)*cos(q2)*sin(theta) + q2dot*cos(phi)*cos(q1)*cos(q2)*sin(theta) + thetadot*cos(phi)*cos(q1)*cos(theta)*sin(q2) + thetadot*cos(phi)*cos(q2)*cos(theta)*sin(q1) - phidot*cos(q1)*sin(phi)*sin(q2)*sin(theta) - phidot*cos(q2)*sin(phi)*sin(q1)*sin(theta) - q1dot*cos(phi)*sin(q1)*sin(q2)*sin(theta) - q2dot*cos(phi)*sin(q1)*sin(q2)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          l*m*(2*phidot*cos(phi)*cos(theta)*sin(q1) + 2*q1dot*cos(q1)*cos(theta)*sin(phi) - 2*thetadot*sin(phi)*sin(q1)*sin(theta) + phidot*cos(phi)*cos(q1)*cos(theta)*sin(q2) + phidot*cos(phi)*cos(q2)*cos(theta)*sin(q1) + q1dot*cos(q1)*cos(q2)*cos(theta)*sin(phi) + q2dot*cos(q1)*cos(q2)*cos(theta)*sin(phi) - q1dot*cos(theta)*sin(phi)*sin(q1)*sin(q2) - q2dot*cos(theta)*sin(phi)*sin(q1)*sin(q2) - thetadot*cos(q1)*sin(phi)*sin(q2)*sin(theta) - thetadot*cos(q2)*sin(phi)*sin(q1)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               l*m*(2*q1dot*cos(q1)*sin(theta) + 2*thetadot*cos(theta)*sin(q1) + 2*phidot*cos(q1)*cos(theta)*sin(phi) + 2*q1dot*cos(phi)*cos(theta)*sin(q1) + q1dot*cos(q1)*cos(q2)*sin(theta) + q2dot*cos(q1)*cos(q2)*sin(theta) + 2*thetadot*cos(phi)*cos(q1)*sin(theta) + thetadot*cos(q1)*cos(theta)*sin(q2) + thetadot*cos(q2)*cos(theta)*sin(q1) - q1dot*sin(q1)*sin(q2)*sin(theta) - q2dot*sin(q1)*sin(q2)*sin(theta) + phidot*cos(q1)*cos(q2)*cos(theta)*sin(phi) + q1dot*cos(phi)*cos(q1)*cos(theta)*sin(q2) + q1dot*cos(phi)*cos(q2)*cos(theta)*sin(q1) + q2dot*cos(phi)*cos(q1)*cos(theta)*sin(q2) + q2dot*cos(phi)*cos(q2)*cos(theta)*sin(q1) + thetadot*cos(phi)*cos(q1)*cos(q2)*sin(theta) - phidot*cos(theta)*sin(phi)*sin(q1)*sin(q2) - thetadot*cos(phi)*sin(q1)*sin(q2)*sin(theta)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (l*m*(2*q1dot*cos(q1 + q2)*sin(theta) + 2*q2dot*cos(q1 + q2)*sin(theta) + 2*thetadot*sin(q1 + q2)*cos(theta) + 2*phidot*cos(q1 + q2)*cos(theta)*sin(phi) + 2*q1dot*sin(q1 + q2)*cos(phi)*cos(theta) + 2*q2dot*sin(q1 + q2)*cos(phi)*cos(theta) + 2*thetadot*cos(q1 + q2)*cos(phi)*sin(theta)))/2;
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     q2dot*(m*(l*cos(q1 + q2)*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta)) - l*sin(q1 + q2)*cos(theta)*sin(psi))*(l*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) + l*cos(theta)*sin(psi)*(cos(q1 + q2) + cos(q1))) + l*m*(l*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) - l*cos(psi)*cos(theta)*(cos(q1 + q2) + cos(q1)))*(sin(q1 + q2)*cos(psi)*cos(theta) + cos(q1 + q2)*sin(phi)*sin(psi) + cos(q1 + q2)*cos(phi)*cos(psi)*sin(theta))) + q1dot*(m*(l*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta))*(cos(q1 + q2) + cos(q1)) + l*cos(psi)*cos(theta)*(sin(q1 + q2) + sin(q1)))*(l*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) - l*cos(psi)*cos(theta)*(cos(q1 + q2) + cos(q1))) + m*(l*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) + l*cos(theta)*sin(psi)*(cos(q1 + q2) + cos(q1)))*(l*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))*(cos(q1 + q2) + cos(q1)) - l*cos(theta)*sin(psi)*(sin(q1 + q2) + sin(q1))) + l^2*m*(cos(psi)*cos(theta)*sin(q1) + cos(q1)*sin(phi)*sin(psi) + cos(phi)*cos(psi)*cos(q1)*sin(theta))*(sin(phi)*sin(psi)*sin(q1) - cos(psi)*cos(q1)*cos(theta) + cos(phi)*cos(psi)*sin(q1)*sin(theta)) - l^2*m*(cos(theta)*sin(psi)*sin(q1) - cos(psi)*cos(q1)*sin(phi) + cos(phi)*cos(q1)*sin(psi)*sin(theta))*(cos(q1)*cos(theta)*sin(psi) + cos(psi)*sin(phi)*sin(q1) - cos(phi)*sin(psi)*sin(q1)*sin(theta))) - thetadot*(m*(l*sin(psi)*sin(theta)*(cos(q1 + q2) + cos(q1)) + l*cos(phi)*cos(theta)*sin(psi)*(sin(q1 + q2) + sin(q1)))*(l*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) + l*cos(theta)*sin(psi)*(cos(q1 + q2) + cos(q1))) - (l^2*mb*sin(2*theta))/24 - m*(l*cos(psi)*sin(theta)*(cos(q1 + q2) + cos(q1)) + l*cos(phi)*cos(psi)*cos(theta)*(sin(q1 + q2) + sin(q1)))*(l*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) - l*cos(psi)*cos(theta)*(cos(q1 + q2) + cos(q1))) + l^2*m*sin(psi)*(cos(q1)*sin(theta) + cos(phi)*cos(theta)*sin(q1))*(cos(q1)*cos(theta)*sin(psi) + cos(psi)*sin(phi)*sin(q1) - cos(phi)*sin(psi)*sin(q1)*sin(theta)) + (l^2*mb*cos(phi)^2*cos(theta)*sin(theta))/6 + (2*d^2*m*cos(theta)*sin(phi)^2*sin(theta))/3 + (l^2*mb*cos(theta)*sin(phi)^2*sin(theta))/12 - l^2*m*cos(psi)*(cos(q1)*sin(theta) + cos(phi)*cos(theta)*sin(q1))*(sin(phi)*sin(psi)*sin(q1) - cos(psi)*cos(q1)*cos(theta) + cos(phi)*cos(psi)*sin(q1)*sin(theta))) + phidot*(l^2*m*sin(q1)*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta))*(sin(phi)*sin(psi)*sin(q1) - cos(psi)*cos(q1)*cos(theta) + cos(phi)*cos(psi)*sin(q1)*sin(theta)) + l^2*m*sin(q1)*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta))*(cos(q1)*cos(theta)*sin(psi) + cos(psi)*sin(phi)*sin(q1) - cos(phi)*sin(psi)*sin(q1)*sin(theta)) + (2*d^2*m*cos(phi)*cos(theta)^2*sin(phi))/3 - (l^2*mb*cos(phi)*cos(theta)^2*sin(phi))/12 + l*m*(cos(phi)*sin(psi) - cos(psi)*sin(phi)*sin(theta))*(l*(sin(phi)*sin(psi) + cos(phi)*cos(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) - l*cos(psi)*cos(theta)*(cos(q1 + q2) + cos(q1)))*(sin(q1 + q2) + sin(q1)) + l*m*(cos(phi)*cos(psi) + sin(phi)*sin(psi)*sin(theta))*(sin(q1 + q2) + sin(q1))*(l*(cos(psi)*sin(phi) - cos(phi)*sin(psi)*sin(theta))*(sin(q1 + q2) + sin(q1)) + l*cos(theta)*sin(psi)*(cos(q1 + q2) + cos(q1)))), (2*d^2*m*phidot*cos(phi)^2*cos(theta))/3 - (l^2*m*psidot*sin(2*theta))/2 - (d^2*m*phidot*cos(theta))/3 - 2*l^2*m*phidot*cos(theta) - (d^2*m*psidot*sin(2*theta))/3 + 2*l^2*m*phidot*cos(phi)^2*cos(theta) - (l^2*mb*phidot*cos(phi)^2*cos(theta))/12 + l^2*m*phidot*cos(q1)^2*cos(theta) - l^2*m*phidot*cos(q2)^2*cos(theta) - 2*l^2*m*phidot*cos(q2)*cos(theta) - l^2*m*psidot*cos(phi)*sin(q2) - (d^2*m*q1dot*sin(phi)*sin(theta))/3 - (d^2*m*q2dot*sin(phi)*sin(theta))/6 - 2*l^2*m*q1dot*sin(phi)*sin(theta) + l^2*m*q1dot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*q1dot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*q2dot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*q2dot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(theta) + l^2*m*phidot*cos(phi)^2*cos(q2)^2*cos(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*psidot*cos(phi)*cos(q1)*sin(q1) - l^2*m*psidot*cos(phi)*cos(q2)*sin(q2) - (2*d^2*m*thetadot*cos(phi)*sin(phi)*sin(theta))/3 - 2*l^2*m*q1dot*cos(q2)*sin(phi)*sin(theta) - l^2*m*q2dot*cos(q2)*sin(phi)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*sin(phi)*sin(theta) + (l^2*mb*thetadot*cos(phi)*sin(phi)*sin(theta))/12 - l^2*m*thetadot*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(phi)^2*cos(q2)*cos(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*cos(theta) + (2*d^2*m*psidot*cos(phi)^2*cos(theta)*sin(theta))/3 + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(theta)*sin(theta) - (l^2*mb*psidot*cos(phi)^2*cos(theta)*sin(theta))/12 - l^2*m*psidot*cos(q1)^2*cos(theta)*sin(theta) + l^2*m*psidot*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) - 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)^2*sin(q2) - l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)*sin(theta) + l^2*m*psidot*cos(phi)^2*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*q1dot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*q2dot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*sin(q1) - 2*l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*q1dot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q2)*sin(phi)*sin(theta) + l^2*m*thetadot*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*thetadot*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*thetadot*cos(phi)*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*thetadot*cos(phi)*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) - 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*q1dot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*q2dot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*q1dot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*psidot*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - l^2*m*q2dot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 2*l^2*m*phidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + 2*l^2*m*thetadot*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q2dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*phidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta), (2*d^2*m*thetadot*cos(phi)^2*cos(theta))/3 - 2*l^2*m*thetadot*cos(theta) - (d^2*m*thetadot*cos(theta))/3 + 2*l^2*m*thetadot*cos(phi)^2*cos(theta) - (l^2*mb*thetadot*cos(phi)^2*cos(theta))/12 + l^2*m*thetadot*cos(q1)^2*cos(theta) - l^2*m*thetadot*cos(q2)^2*cos(theta) + (d^2*m*q1dot*cos(phi)*cos(theta))/3 + (d^2*m*q2dot*cos(phi)*cos(theta))/6 + l^2*m*q1dot*cos(phi)*cos(theta) + l^2*m*q2dot*cos(phi)*cos(theta) - 2*l^2*m*thetadot*cos(q2)*cos(theta) + l^2*m*q1dot*sin(q2)*sin(theta) + l^2*m*q2dot*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)^2*sin(q2)*sin(theta) - l^2*m*q2dot*cos(q1)^2*sin(q2)*sin(theta) - l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(theta) + l^2*m*thetadot*cos(phi)^2*cos(q2)^2*cos(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*phidot*cos(theta)*sin(phi)*sin(q2) - l^2*m*q1dot*cos(q1)*sin(q1)*sin(theta) + l^2*m*q2dot*cos(q1)*sin(q1)*sin(theta) + l^2*m*q1dot*cos(q2)*sin(q2)*sin(theta) + l^2*m*q2dot*cos(q2)*sin(q2)*sin(theta) + l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*q1dot*cos(phi)*cos(q2)^2*cos(theta) - l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*q2dot*cos(phi)*cos(q2)^2*cos(theta) + 2*l^2*m*thetadot*cos(phi)^2*cos(q2)*cos(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*cos(theta) + (2*d^2*m*psidot*cos(phi)*cos(theta)^2*sin(phi))/3 + 2*l^2*m*psidot*cos(phi)*cos(theta)^2*sin(phi) - (l^2*mb*psidot*cos(phi)*cos(theta)^2*sin(phi))/12 + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + 2*l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) - l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)^2*sin(phi) + l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)^2*sin(phi) - l^2*m*phidot*cos(q1)*cos(theta)*sin(phi)*sin(q1) + l^2*m*phidot*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - l^2*m*q2dot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) - 2*l^2*m*thetadot*cos(q1)*cos(theta)*sin(q1)*sin(q2) - l^2*m*psidot*cos(theta)*sin(phi)*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)^2*sin(phi) - 2*l^2*m*phidot*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*q1dot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*q2dot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)^2*sin(phi) + l^2*m*psidot*cos(q1)*cos(theta)*sin(phi)*sin(q1)*sin(theta) - l^2*m*psidot*cos(q2)*cos(theta)*sin(phi)*sin(q2)*sin(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(q1)^2*cos(theta)*sin(phi)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)^2*sin(phi) - 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1)*sin(theta) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)^2*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)^2*sin(phi)*sin(q1)*sin(q2), (l^2*m*psidot*sin(2*q1))/2 - (l^2*m*psidot*sin(2*q2))/2 - l^2*m*psidot*sin(q2) + 2*l^2*m*psidot*cos(q1)^2*sin(q2) + l^2*m*psidot*cos(theta)^2*sin(q2) + (d^2*m*phidot*cos(phi)*cos(theta))/3 + l^2*m*phidot*cos(phi)*cos(theta) - (d^2*m*thetadot*sin(phi)*sin(theta))/3 + l^2*m*phidot*sin(q2)*sin(theta) - 2*l^2*m*thetadot*sin(phi)*sin(theta) - 2*l^2*m*phidot*cos(q1)^2*sin(q2)*sin(theta) + l^2*m*thetadot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*thetadot*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)^2*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(q1)^2*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(q1) + l^2*m*psidot*cos(phi)*cos(theta)*sin(theta) - l^2*m*phidot*cos(q1)*sin(q1)*sin(theta) + l^2*m*phidot*cos(q2)*sin(q2)*sin(theta) - l^2*m*q2dot*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*thetadot*cos(q2)*sin(phi)*sin(theta) + l^2*m*phidot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*phidot*cos(phi)*cos(q2)^2*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2) - l^2*m*psidot*cos(q1)*cos(theta)^2*sin(q1) + l^2*m*psidot*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)^2*sin(q1) + l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - l^2*m*thetadot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)^2*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) - 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) + l^2*m*thetadot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*thetadot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta), l^2*m*psidot*cos(q1)^2*sin(q2) - (l^2*m*psidot*sin(2*q2))/2 - l^2*m*psidot*sin(q2) - (l^2*m*psidot*sin(2*q1))/2 + (d^2*m*phidot*cos(phi)*cos(theta))/6 + l^2*m*phidot*cos(phi)*cos(theta) - (d^2*m*thetadot*sin(phi)*sin(theta))/6 + l^2*m*phidot*sin(q2)*sin(theta) - l^2*m*phidot*cos(q1)^2*sin(q2)*sin(theta) - l^2*m*thetadot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*thetadot*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)^2*cos(theta)^2*sin(q2) - l^2*m*psidot*cos(q1)^2*cos(theta)^2*sin(q2) + l^2*m*psidot*cos(q1)*cos(q2)*sin(q1) - l^2*m*psidot*cos(phi)*cos(theta)*sin(theta) + l^2*m*phidot*cos(q1)*sin(q1)*sin(theta) + l^2*m*phidot*cos(q2)*sin(q2)*sin(theta) - l^2*m*q1dot*cos(theta)*sin(phi)*sin(q2) - l^2*m*q2dot*cos(theta)*sin(phi)*sin(q2) - l^2*m*thetadot*cos(q2)*sin(phi)*sin(theta) - l^2*m*phidot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*phidot*cos(phi)*cos(q2)^2*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2) + l^2*m*psidot*cos(q1)*cos(theta)^2*sin(q1) + l^2*m*psidot*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)^2*sin(q1) + l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(theta) - l^2*m*phidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - l^2*m*thetadot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)^2*sin(q2) + l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) - l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) - 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) - l^2*m*phidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - l^2*m*thetadot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*thetadot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) - l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta);
 0, 0, 0, (d^2*m*psidot*sin(2*theta))/3 + (l^2*m*psidot*sin(2*theta))/2 - (d^2*m*phidot*cos(theta))/3 + (l^2*mb*phidot*cos(theta))/12 + (2*d^2*m*phidot*cos(phi)^2*cos(theta))/3 + 2*l^2*m*phidot*cos(phi)^2*cos(theta) - (l^2*mb*phidot*cos(phi)^2*cos(theta))/12 + l^2*m*psidot*cos(phi)*sin(q2) + (d^2*m*q1dot*sin(phi)*sin(theta))/3 + (d^2*m*q2dot*sin(phi)*sin(theta))/6 + l^2*m*q1dot*sin(phi)*sin(theta) + l^2*m*q2dot*sin(phi)*sin(theta) + l^2*m*q1dot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*q1dot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*q2dot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*q2dot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(theta) + l^2*m*phidot*cos(phi)^2*cos(q2)^2*cos(theta) - l^2*m*psidot*cos(phi)*cos(q1)*sin(q1) + l^2*m*psidot*cos(phi)*cos(q2)*sin(q2) - l^2*m*phidot*cos(phi)*sin(q2)*sin(theta) + 2*l^2*m*phidot*cos(phi)^2*cos(q2)*cos(theta) - (2*d^2*m*psidot*cos(phi)^2*cos(theta)*sin(theta))/3 - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(theta)*sin(theta) + (l^2*mb*psidot*cos(phi)^2*cos(theta)*sin(theta))/12 + l^2*m*psidot*cos(q1)^2*cos(theta)*sin(theta) - l^2*m*psidot*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) + 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)^2*sin(q2) + l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)*sin(theta) - l^2*m*psidot*cos(phi)^2*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*q1dot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*q2dot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*sin(q1) - 2*l^2*m*phidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*phidot*cos(phi)*cos(q1)*sin(q1)*sin(theta) - l^2*m*phidot*cos(phi)*cos(q2)*sin(q2)*sin(theta) - l^2*m*q1dot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(phi)*cos(q1)^2*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) + 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*sin(q1)*sin(theta) + l^2*m*q1dot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*q2dot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*q1dot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) - 2*l^2*m*psidot*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - l^2*m*q2dot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*phidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*q2dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*phidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (l^2*mb*phidot*sin(2*phi))/24 - (3*l^2*m*phidot*sin(2*phi))/4 - (d^2*m*phidot*sin(2*phi))/3 - (l^2*m*q1dot*sin(2*q1))/2 - (3*l^2*m*q2dot*sin(q2))/4 - (l^2*m*phidot*sin(2*phi)*cos(q2))/2 - (l^2*m*q2dot*cos(2*phi)*sin(q2))/4 - (l^2*m*q1dot*cos(2*q1)*sin(q2))/2 - (l^2*m*q1dot*sin(2*q1)*cos(q2))/2 - (l^2*m*q2dot*cos(2*q1)*sin(q2))/4 - (l^2*m*q2dot*sin(2*q1)*cos(q2))/4 + (l^2*m*phidot*cos(2*q1)*sin(2*phi))/2 + (l^2*m*q1dot*cos(2*phi)*sin(2*q1))/2 - (l^2*m*q1dot*cos(2*q1)*sin(2*q2))/4 - (l^2*m*q1dot*cos(2*q2)*sin(2*q1))/4 - (l^2*m*q2dot*cos(2*q1)*sin(2*q2))/4 - (l^2*m*q2dot*cos(2*q2)*sin(2*q1))/4 + (l^2*m*phidot*cos(2*q1)*sin(2*phi)*cos(q2))/2 + (l^2*m*q1dot*cos(2*phi)*cos(2*q1)*sin(q2))/2 + (l^2*m*q1dot*cos(2*phi)*sin(2*q1)*cos(q2))/2 + (l^2*m*q2dot*cos(2*phi)*cos(2*q1)*sin(q2))/4 + (l^2*m*q2dot*cos(2*phi)*sin(2*q1)*cos(q2))/4 - (l^2*m*phidot*sin(2*phi)*sin(2*q1)*sin(q2))/2 + (l^2*m*phidot*cos(2*q1)*cos(2*q2)*sin(2*phi))/4 + (l^2*m*q1dot*cos(2*phi)*cos(2*q1)*sin(2*q2))/4 + (l^2*m*q1dot*cos(2*phi)*cos(2*q2)*sin(2*q1))/4 + (l^2*m*q2dot*cos(2*phi)*cos(2*q1)*sin(2*q2))/4 + (l^2*m*q2dot*cos(2*phi)*cos(2*q2)*sin(2*q1))/4 - (l^2*m*phidot*sin(2*phi)*sin(2*q1)*sin(2*q2))/4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (l^2*mb*thetadot*sin(2*phi))/24 - l^2*m*thetadot*sin(2*phi) - (d^2*m*thetadot*sin(2*phi))/3 - (d^2*m*psidot*cos(theta))/3 + (l^2*mb*psidot*cos(theta))/12 - (d^2*m*q1dot*sin(phi))/3 - (d^2*m*q2dot*sin(phi))/6 - l^2*m*q1dot*sin(phi) - l^2*m*q2dot*sin(phi) + (2*d^2*m*psidot*cos(phi)^2*cos(theta))/3 + 2*l^2*m*psidot*cos(phi)^2*cos(theta) - (l^2*mb*psidot*cos(phi)^2*cos(theta))/12 - l^2*m*q1dot*cos(q1)^2*sin(phi) + l^2*m*q1dot*cos(q2)^2*sin(phi) + l^2*m*q2dot*cos(q1)^2*sin(phi) + l^2*m*q2dot*cos(q2)^2*sin(phi) + l^2*m*phidot*cos(phi)*sin(q2) - l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta) + l^2*m*psidot*cos(phi)^2*cos(q2)^2*cos(theta) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)^2*sin(phi) - 2*l^2*m*q2dot*cos(q1)^2*cos(q2)^2*sin(phi) - l^2*m*phidot*cos(phi)*cos(q1)*sin(q1) + l^2*m*phidot*cos(phi)*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q2)*sin(phi) - l^2*m*psidot*cos(phi)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta) - 2*l^2*m*phidot*cos(phi)*cos(q1)^2*sin(q2) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(phi) - l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(phi) + l^2*m*thetadot*cos(phi)*cos(q1)^2*sin(phi) - l^2*m*thetadot*cos(phi)*cos(q2)^2*sin(phi) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)^2*sin(phi) - 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*sin(q1) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*psidot*cos(phi)*cos(q1)*sin(q1)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + l^2*m*q2dot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*sin(phi) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*sin(q1)*sin(theta) + 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*q2dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (l^2*m*thetadot*sin(2*q2))/2 - (l^2*m*thetadot*sin(2*q1))/2 - (d^2*m*phidot*sin(phi))/3 - l^2*m*phidot*sin(phi) + l^2*m*thetadot*sin(q2) - l^2*m*phidot*cos(q1)^2*sin(phi) + l^2*m*phidot*cos(q2)^2*sin(phi) - l^2*m*thetadot*cos(phi)^2*sin(q2) - 2*l^2*m*thetadot*cos(q1)^2*sin(q2) - l^2*m*q2dot*cos(phi)*sin(q2) + (d^2*m*psidot*sin(phi)*sin(theta))/3 + l^2*m*psidot*sin(phi)*sin(theta) + l^2*m*psidot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(q2)^2*sin(phi)*sin(theta) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)^2*sin(phi) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(q1) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(phi) + l^2*m*thetadot*cos(phi)^2*cos(q1)*sin(q1) - l^2*m*thetadot*cos(phi)^2*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*sin(q1) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (l^2*m*thetadot*sin(2*q1))/2 + (l^2*m*thetadot*sin(2*q2))/2 - (d^2*m*phidot*sin(phi))/6 - l^2*m*phidot*sin(phi) + l^2*m*phidot*cos(q1)^2*sin(phi) + l^2*m*phidot*cos(q2)^2*sin(phi) - l^2*m*thetadot*cos(phi)^2*sin(q2) - l^2*m*thetadot*cos(q1)^2*sin(q2) - l^2*m*q1dot*cos(phi)*sin(q2) - l^2*m*q2dot*cos(phi)*sin(q2) + (d^2*m*psidot*sin(phi)*sin(theta))/6 + l^2*m*psidot*sin(phi)*sin(theta) - l^2*m*psidot*cos(q1)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(q2)^2*sin(phi)*sin(theta) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)^2*sin(phi) + l^2*m*thetadot*cos(phi)^2*cos(q1)^2*sin(q2) - l^2*m*thetadot*cos(q1)*cos(q2)*sin(q1) - l^2*m*phidot*cos(q1)^2*cos(q2)*sin(phi) - l^2*m*thetadot*cos(phi)^2*cos(q1)*sin(q1) - l^2*m*thetadot*cos(phi)^2*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)*cos(theta)*sin(phi)*sin(q2) + l^2*m*phidot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*sin(q1) + l^2*m*psidot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) - l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - l^2*m*psidot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2);
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (d^2*m*thetadot*cos(theta))/3 - (l^2*mb*thetadot*cos(theta))/12 - (2*d^2*m*thetadot*cos(phi)^2*cos(theta))/3 - 2*l^2*m*thetadot*cos(phi)^2*cos(theta) + (l^2*mb*thetadot*cos(phi)^2*cos(theta))/12 - (d^2*m*q1dot*cos(phi)*cos(theta))/3 - (d^2*m*q2dot*cos(phi)*cos(theta))/6 - 2*l^2*m*q1dot*cos(phi)*cos(theta) + l^2*m*q1dot*sin(q2)*sin(theta) + l^2*m*q2dot*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(q1)^2*sin(q2)*sin(theta) - l^2*m*q2dot*cos(q1)^2*sin(q2)*sin(theta) + l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(theta) - l^2*m*thetadot*cos(phi)^2*cos(q2)^2*cos(theta) - 2*l^2*m*q1dot*cos(phi)*cos(q2)*cos(theta) - l^2*m*q2dot*cos(phi)*cos(q2)*cos(theta) - l^2*m*q1dot*cos(q1)*sin(q1)*sin(theta) + l^2*m*q2dot*cos(q1)*sin(q1)*sin(theta) + l^2*m*q1dot*cos(q2)*sin(q2)*sin(theta) + l^2*m*q2dot*cos(q2)*sin(q2)*sin(theta) + l^2*m*thetadot*cos(phi)*sin(q2)*sin(theta) + l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*q1dot*cos(phi)*cos(q2)^2*cos(theta) - l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*q2dot*cos(phi)*cos(q2)^2*cos(theta) - 2*l^2*m*thetadot*cos(phi)^2*cos(q2)*cos(theta) - (2*d^2*m*psidot*cos(phi)*cos(theta)^2*sin(phi))/3 - 2*l^2*m*psidot*cos(phi)*cos(theta)^2*sin(phi) + (l^2*mb*psidot*cos(phi)*cos(theta)^2*sin(phi))/12 + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + 2*l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) + l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)^2*sin(phi) - l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)^2*sin(phi) - 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - l^2*m*q2dot*cos(q1)*cos(q2)*sin(q1)*sin(theta) + 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*thetadot*cos(phi)*cos(q1)*sin(q1)*sin(theta) + l^2*m*thetadot*cos(phi)*cos(q2)*sin(q2)*sin(theta) + l^2*m*psidot*cos(theta)*sin(phi)*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + l^2*m*q2dot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) - 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)^2*sin(phi) - 2*l^2*m*q1dot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*q2dot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*sin(q2)*sin(theta) - 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - l^2*m*q2dot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*sin(q1)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)^2*sin(phi) - l^2*m*psidot*cos(q1)*cos(theta)*sin(phi)*sin(q1)*sin(theta) + l^2*m*psidot*cos(q2)*cos(theta)*sin(phi)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(theta)*sin(phi)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)^2*sin(phi) - 2*l^2*m*q1dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*q2dot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1)*sin(theta) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)^2*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)^2*sin(phi)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (d^2*m*thetadot*sin(2*phi))/3 + l^2*m*thetadot*sin(2*phi) - (l^2*mb*thetadot*sin(2*phi))/24 + (d^2*m*psidot*cos(theta))/3 - (l^2*mb*psidot*cos(theta))/12 + (d^2*m*q1dot*sin(phi))/3 + (d^2*m*q2dot*sin(phi))/6 + 2*l^2*m*q1dot*sin(phi) - (2*d^2*m*psidot*cos(phi)^2*cos(theta))/3 - 2*l^2*m*psidot*cos(phi)^2*cos(theta) + (l^2*mb*psidot*cos(phi)^2*cos(theta))/12 - l^2*m*q1dot*cos(q1)^2*sin(phi) + l^2*m*q1dot*cos(q2)^2*sin(phi) + l^2*m*q2dot*cos(q1)^2*sin(phi) + l^2*m*q2dot*cos(q2)^2*sin(phi) + 2*l^2*m*q1dot*cos(q2)*sin(phi) + l^2*m*q2dot*cos(q2)*sin(phi) + l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta) - l^2*m*psidot*cos(phi)^2*cos(q2)^2*cos(theta) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)^2*sin(phi) - 2*l^2*m*q2dot*cos(q1)^2*cos(q2)^2*sin(phi) + 2*l^2*m*thetadot*cos(phi)*cos(q2)*sin(phi) + l^2*m*psidot*cos(phi)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta) - 2*l^2*m*q1dot*cos(q1)^2*cos(q2)*sin(phi) - l^2*m*q2dot*cos(q1)^2*cos(q2)*sin(phi) - l^2*m*thetadot*cos(phi)*cos(q1)^2*sin(phi) + l^2*m*thetadot*cos(phi)*cos(q2)^2*sin(phi) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)^2*sin(phi) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*psidot*cos(phi)*cos(q1)*sin(q1)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*q1dot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + l^2*m*q2dot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*sin(phi) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*sin(q1)*sin(theta) + 2*l^2*m*q1dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*q2dot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(phi)*cos(q1)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (l^2*m*(2*q1dot*sin(2*q1) + q1dot*sin(2*q1 + 2*q2) + q2dot*sin(2*q1 + 2*q2) - q2dot*sin(q2) + 2*q1dot*sin(2*q1 + q2) + q2dot*sin(2*q1 + q2)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (l^2*m*phidot*sin(2*q1))/2 - (l^2*m*phidot*sin(2*q2))/2 + (d^2*m*thetadot*sin(phi))/3 - l^2*m*phidot*sin(q2) + 2*l^2*m*thetadot*sin(phi) + 2*l^2*m*phidot*cos(q1)^2*sin(q2) - l^2*m*thetadot*cos(q1)^2*sin(phi) + l^2*m*thetadot*cos(q2)^2*sin(phi) - (d^2*m*psidot*cos(phi)*cos(theta))/3 - 2*l^2*m*psidot*cos(phi)*cos(theta) + 2*l^2*m*thetadot*cos(q2)*sin(phi) + l^2*m*psidot*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi) - 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(q1) - l^2*m*psidot*cos(q1)*sin(q1)*sin(theta) + l^2*m*psidot*cos(q2)*sin(q2)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) + 2*l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (d^2*m*thetadot*sin(phi))/6 - (l^2*m*phidot*sin(2*q2))/2 - (l^2*m*phidot*sin(2*q1))/2 - l^2*m*phidot*sin(q2) + l^2*m*phidot*cos(q1)^2*sin(q2) + l^2*m*thetadot*cos(q1)^2*sin(phi) + l^2*m*thetadot*cos(q2)^2*sin(phi) - (d^2*m*psidot*cos(phi)*cos(theta))/6 + l^2*m*thetadot*cos(q2)*sin(phi) + l^2*m*psidot*sin(q2)*sin(theta) - l^2*m*psidot*cos(q1)^2*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi) - l^2*m*psidot*cos(phi)*cos(q2)*cos(theta) + l^2*m*phidot*cos(q1)*cos(q2)*sin(q1) + l^2*m*psidot*cos(q1)*sin(q1)*sin(theta) + l^2*m*psidot*cos(q2)*sin(q2)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta) - l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2) - l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*psidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) + l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2) + l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2);
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (l^2*m*psidot*sin(2*q2))/2 - (l^2*m*psidot*sin(2*q1))/2 + l^2*m*psidot*sin(q2) - 2*l^2*m*psidot*cos(q1)^2*sin(q2) - l^2*m*psidot*cos(theta)^2*sin(q2) + (d^2*m*phidot*cos(phi)*cos(theta))/3 + 2*l^2*m*phidot*cos(phi)*cos(theta) - (d^2*m*thetadot*sin(phi)*sin(theta))/3 - l^2*m*phidot*sin(q2)*sin(theta) - l^2*m*thetadot*sin(phi)*sin(theta) + 2*l^2*m*phidot*cos(q1)^2*sin(q2)*sin(theta) - l^2*m*thetadot*cos(q1)^2*sin(phi)*sin(theta) + l^2*m*thetadot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)^2*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(q1)^2*cos(theta)^2*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q2)*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(q1) - l^2*m*psidot*cos(phi)*cos(theta)*sin(theta) + l^2*m*phidot*cos(q1)*sin(q1)*sin(theta) - l^2*m*phidot*cos(q2)*sin(q2)*sin(theta) - l^2*m*q2dot*cos(theta)*sin(phi)*sin(q2) - l^2*m*phidot*cos(phi)*cos(q1)^2*cos(theta) + l^2*m*phidot*cos(phi)*cos(q2)^2*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2) + l^2*m*psidot*cos(q1)*cos(theta)^2*sin(q1) - l^2*m*psidot*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)^2*sin(q1) - l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) + l^2*m*thetadot*cos(phi)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)^2*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - l^2*m*thetadot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) + l^2*m*thetadot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (l^2*m*thetadot*sin(2*q1))/2 - (l^2*m*thetadot*sin(2*q2))/2 - (d^2*m*phidot*sin(phi))/3 - 2*l^2*m*phidot*sin(phi) - l^2*m*thetadot*sin(q2) + l^2*m*phidot*cos(q1)^2*sin(phi) - l^2*m*phidot*cos(q2)^2*sin(phi) + l^2*m*thetadot*cos(phi)^2*sin(q2) + 2*l^2*m*thetadot*cos(q1)^2*sin(q2) - 2*l^2*m*phidot*cos(q2)*sin(phi) - l^2*m*q2dot*cos(phi)*sin(q2) - (d^2*m*psidot*sin(phi)*sin(theta))/3 - l^2*m*psidot*sin(phi)*sin(theta) - l^2*m*psidot*cos(q1)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)^2*sin(phi) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(q1) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(phi) - l^2*m*thetadot*cos(phi)^2*cos(q1)*sin(q1) + l^2*m*thetadot*cos(phi)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*sin(q1) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) + l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (l^2*m*phidot*sin(2*q2))/2 - (l^2*m*phidot*sin(2*q1))/2 - (d^2*m*thetadot*sin(phi))/3 + l^2*m*phidot*sin(q2) - 2*l^2*m*thetadot*sin(phi) - 2*l^2*m*phidot*cos(q1)^2*sin(q2) + l^2*m*thetadot*cos(q1)^2*sin(phi) - l^2*m*thetadot*cos(q2)^2*sin(phi) + (d^2*m*psidot*cos(phi)*cos(theta))/3 + 2*l^2*m*psidot*cos(phi)*cos(theta) - 2*l^2*m*thetadot*cos(q2)*sin(phi) - l^2*m*psidot*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi) + 2*l^2*m*psidot*cos(phi)*cos(q2)*cos(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(q1) + l^2*m*psidot*cos(q1)*sin(q1)*sin(theta) - l^2*m*psidot*cos(q2)*sin(q2)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta) + l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - 2*l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -l^2*m*q2dot*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -l^2*m*sin(q2)*(q1dot + q2dot + thetadot*cos(phi) + psidot*cos(theta)*sin(phi));
 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (l^2*m*psidot*sin(2*q1))/2 + (l^2*m*psidot*sin(2*q2))/2 + l^2*m*psidot*sin(q2) - l^2*m*psidot*cos(q1)^2*sin(q2) + (d^2*m*phidot*cos(phi)*cos(theta))/6 - (d^2*m*thetadot*sin(phi)*sin(theta))/6 - l^2*m*phidot*sin(q2)*sin(theta) - l^2*m*thetadot*sin(phi)*sin(theta) + l^2*m*phidot*cos(q1)^2*sin(q2)*sin(theta) + l^2*m*thetadot*cos(q1)^2*sin(phi)*sin(theta) + l^2*m*thetadot*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)^2*cos(theta)^2*sin(q2) + l^2*m*psidot*cos(q1)^2*cos(theta)^2*sin(q2) + l^2*m*phidot*cos(phi)*cos(q2)*cos(theta) - l^2*m*psidot*cos(q1)*cos(q2)*sin(q1) + l^2*m*psidot*cos(phi)*cos(theta)*sin(theta) - l^2*m*phidot*cos(q1)*sin(q1)*sin(theta) - l^2*m*phidot*cos(q2)*sin(q2)*sin(theta) + l^2*m*q1dot*cos(theta)*sin(phi)*sin(q2) + l^2*m*phidot*cos(phi)*cos(q1)^2*cos(theta) + l^2*m*phidot*cos(phi)*cos(q2)^2*cos(theta) - 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2) - l^2*m*psidot*cos(q1)*cos(theta)^2*sin(q1) - l^2*m*psidot*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) - l^2*m*psidot*cos(phi)^2*cos(q1)*cos(theta)^2*sin(q1) - l^2*m*psidot*cos(phi)^2*cos(q2)*cos(theta)^2*sin(q2) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) - 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(theta) + l^2*m*phidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) + l^2*m*thetadot*cos(phi)*cos(theta)*sin(phi)*sin(q2) + l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(theta)^2*sin(q2) - l^2*m*phidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + l^2*m*psidot*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta)*sin(theta) + 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) - l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)*cos(theta)^2*sin(q1) + 4*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta)*sin(theta) + l^2*m*phidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) + l^2*m*thetadot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) + l^2*m*thetadot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)*cos(q2)^2*cos(theta)^2*sin(q1) + 2*l^2*m*psidot*cos(phi)^2*cos(q1)^2*cos(q2)*cos(theta)^2*sin(q2) + l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(theta) - l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) + 2*l^2*m*phidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2) - l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*thetadot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*thetadot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 4*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2)*sin(theta),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            l^2*m*thetadot*cos(phi)^2*sin(q2) - (l^2*m*thetadot*sin(2*q2))/2 - (d^2*m*phidot*sin(phi))/6 - l^2*m*phidot*cos(q1)^2*sin(phi) - l^2*m*phidot*cos(q2)^2*sin(phi) - (l^2*m*thetadot*sin(2*q1))/2 + l^2*m*thetadot*cos(q1)^2*sin(q2) - l^2*m*phidot*cos(q2)*sin(phi) + l^2*m*q1dot*cos(phi)*sin(q2) - (d^2*m*psidot*sin(phi)*sin(theta))/6 - l^2*m*psidot*sin(phi)*sin(theta) + l^2*m*psidot*cos(q1)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(q2)^2*sin(phi)*sin(theta) + 2*l^2*m*phidot*cos(q1)^2*cos(q2)^2*sin(phi) - l^2*m*thetadot*cos(phi)^2*cos(q1)^2*sin(q2) + l^2*m*thetadot*cos(q1)*cos(q2)*sin(q1) + l^2*m*phidot*cos(q1)^2*cos(q2)*sin(phi) + l^2*m*thetadot*cos(phi)^2*cos(q1)*sin(q1) + l^2*m*thetadot*cos(phi)^2*cos(q2)*sin(q2) + 2*l^2*m*thetadot*cos(q1)*cos(q2)^2*sin(q1) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*thetadot*cos(phi)^2*cos(q1)^2*cos(q2)*sin(q2) - 2*l^2*m*psidot*cos(q1)^2*cos(q2)^2*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)*cos(theta)*sin(phi)*sin(q2) - l^2*m*phidot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - l^2*m*thetadot*cos(phi)^2*cos(q1)*cos(q2)*sin(q1) - l^2*m*psidot*cos(q1)^2*cos(q2)*sin(phi)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(phi)*sin(q1) + l^2*m*psidot*cos(phi)*cos(q2)*cos(theta)*sin(phi)*sin(q2) - 2*l^2*m*phidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + l^2*m*psidot*cos(q1)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta)*sin(phi)*sin(q2) - l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(phi)*sin(q1) + 2*l^2*m*psidot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2)*sin(theta) - 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)^2*cos(theta)*sin(phi)*sin(q1) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta)*sin(phi)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (l^2*m*phidot*sin(2*q1))/2 + (l^2*m*phidot*sin(2*q2))/2 - (d^2*m*thetadot*sin(phi))/6 + l^2*m*phidot*sin(q2) - l^2*m*phidot*cos(q1)^2*sin(q2) - l^2*m*thetadot*cos(q1)^2*sin(phi) - l^2*m*thetadot*cos(q2)^2*sin(phi) + (d^2*m*psidot*cos(phi)*cos(theta))/6 - l^2*m*thetadot*cos(q2)*sin(phi) - l^2*m*psidot*sin(q2)*sin(theta) + l^2*m*psidot*cos(q1)^2*sin(q2)*sin(theta) + 2*l^2*m*thetadot*cos(q1)^2*cos(q2)^2*sin(phi) + l^2*m*psidot*cos(phi)*cos(q2)*cos(theta) - l^2*m*phidot*cos(q1)*cos(q2)*sin(q1) - l^2*m*psidot*cos(q1)*sin(q1)*sin(theta) - l^2*m*psidot*cos(q2)*sin(q2)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)^2*cos(theta) + l^2*m*psidot*cos(phi)*cos(q2)^2*cos(theta) - 2*l^2*m*phidot*cos(q1)*cos(q2)^2*sin(q1) - 2*l^2*m*phidot*cos(q1)^2*cos(q2)*sin(q2) + l^2*m*thetadot*cos(q1)^2*cos(q2)*sin(phi) - 2*l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)^2*cos(theta) + l^2*m*psidot*cos(q1)*cos(q2)*sin(q1)*sin(theta) - l^2*m*thetadot*cos(q1)*sin(phi)*sin(q1)*sin(q2) - l^2*m*psidot*cos(phi)*cos(q1)^2*cos(q2)*cos(theta) + 2*l^2*m*psidot*cos(q1)*cos(q2)^2*sin(q1)*sin(theta) + 2*l^2*m*psidot*cos(q1)^2*cos(q2)*sin(q2)*sin(theta) + l^2*m*psidot*cos(phi)*cos(q1)*cos(theta)*sin(q1)*sin(q2) - 2*l^2*m*thetadot*cos(q1)*cos(q2)*sin(phi)*sin(q1)*sin(q2) + 2*l^2*m*psidot*cos(phi)*cos(q1)*cos(q2)*cos(theta)*sin(q1)*sin(q2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               l^2*m*sin(q2)*(q1dot + thetadot*cos(phi) + psidot*cos(theta)*sin(phi)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0];

% Gravity matrix
G = [
                                                                                                                                                               0;
                                                                                                                                                               0;
                                                                                                                                                    2*g*m + g*mb;
                                                                                                                                                               0;
 - g*m*(l*cos(q1)*cos(theta) - l*cos(phi)*sin(q1)*sin(theta)) - g*m*(cos(theta)*(l*cos(q1 + q2) + l*cos(q1)) - cos(phi)*sin(theta)*(l*sin(q1 + q2) + l*sin(q1)));
                                                                        g*m*cos(theta)*sin(phi)*(l*sin(q1 + q2) + l*sin(q1)) + g*l*m*cos(theta)*sin(phi)*sin(q1);
   g*m*(l*sin(q1)*sin(theta) - l*cos(phi)*cos(q1)*cos(theta)) + g*m*(sin(theta)*(l*sin(q1 + q2) + l*sin(q1)) - cos(phi)*cos(theta)*(l*cos(q1 + q2) + l*cos(q1)));
                                                                                            g*m*(l*sin(q1 + q2)*sin(theta) - l*cos(q1 + q2)*cos(phi)*cos(theta))];

                                                                                        


% Control gains

% Picking

% Position  
k_p_x = 10;
k_d_x = 6;
k_p_y = 0;
k_d_y = 0;
k_p_z = 50;
k_d_z = 5;
k_p = [k_p_x 0 0;0 k_p_y 0;0 0 k_p_z];
k_d = [k_d_x 0 0;0 k_d_y 0;0 0 k_d_z];

% Orientation
k_p_attitude_psi = 0;
k_d_attitude_psi = 0;
k_p_attitude_theta = 250;
k_d_attitude_theta = 1;
k_p_attitude_phi = 0;
k_d_attitude_phi = 0;

k_p_attitude = [k_p_attitude_psi 0 0;0 k_p_attitude_theta 0;0 0 k_p_attitude_phi];
k_d_attitude = [k_d_attitude_psi 0 0;0 k_d_attitude_theta 0;0 0 k_d_attitude_phi];

% Joint Values
k_p_q_1 = 250;
k_d_w_1 = 0;
k_p_q_2 = 40;
k_d_w_2 = 1;

% Moving

% % Position  
% k_p_x = 5;
% k_d_x = 4;
% k_p_y = 0;
% k_d_y = 0;
% k_p_z = 50;
% k_d_z = 5;
% k_p = [k_p_x 0 0;0 k_p_y 0;0 0 k_p_z];
% k_d = [k_d_x 0 0;0 k_d_y 0;0 0 k_d_z];
% 
% % Orientation
% k_p_attitude_psi = 0;
% k_d_attitude_psi = 0;
% k_p_attitude_theta = 80;
% k_d_attitude_theta = 2;
% k_p_attitude_phi = 0;
% k_d_attitude_phi = 0;
% 
% k_p_attitude = [k_p_attitude_psi 0 0;0 k_p_attitude_theta 0;0 0 k_p_attitude_phi];
% k_d_attitude = [k_d_attitude_psi 0 0;0 k_d_attitude_theta 0;0 0 k_d_attitude_phi];
% 
% % Joint Values
% k_p_q_1 = 50;
% k_d_w_1 = 0;
% k_p_q_2 = 50;
% k_d_w_2 = 0;

% Drop

% % Position  
% k_p_x = 28;
% k_d_x = 10;
% k_p_y = 0;
% k_d_y = 0;
% k_p_z = 90;
% k_d_z = 5;
% k_p = [k_p_x 0 0;0 k_p_y 0;0 0 k_p_z];
% k_d = [k_d_x 0 0;0 k_d_y 0;0 0 k_d_z];
% 
% % Orientation
% k_p_attitude_psi = 0;
% k_d_attitude_psi = 0;
% k_p_attitude_theta = 250;
% k_d_attitude_theta = 1;
% k_p_attitude_phi = 0;
% k_d_attitude_phi = 0;
% 
% k_p_attitude = [k_p_attitude_psi 0 0;0 k_p_attitude_theta 0;0 0 k_p_attitude_phi];
% k_d_attitude = [k_d_attitude_psi 0 0;0 k_d_attitude_theta 0;0 0 k_d_attitude_phi];
% 
% % Joint Values
% k_p_q_1 = 250;
% k_d_w_1 = 0;
% k_p_q_2 = 40;
% k_d_w_2 = 1;



k_p_q = [k_p_q_1 0;0 k_p_q_2];
k_d_w = [k_d_w_1 0;0 k_d_w_2];

% Positions and Velocity error of center of mass of quadcopter
e_p = zeta_des(1:3)-zeta(1:3);
ed_p = -zetadot(1:3);

rdd_des = k_p*e_p+k_d*ed_p;

% Total thrust force
F(1,1) = (mb+2*m)*(rdd_des(3) + g); 

% Desired values of theta and phi 
zeta_des(5:6)=(1/g)*inv([cos(psi),sin(psi);sin(psi),-cos(psi)])*[rdd_des(1);rdd_des(2)];

% Orientation error
e_rot = zeta_des(4:6)- zeta(4:6);  
e_omega = -zetadot(4:6); 

% Moments about z,y,x axis for quadcopter
F(2:4,1) = k_p_attitude*e_rot + k_d_attitude*e_omega;  

% Position and velocity error for 2R arm
e_q = zeta_des(7:8)-zeta(7:8);
e_w = -zetadot(7:8);

% Joint torques
Mr(1:2,1)=k_p_q*e_q + k_d_w*e_w;  

% Input

fb =[0;0;F(1,1)];
% Input to the system
u =[R*fb;(T')*R*F(2:4,1);Mr];

% Dynamic equations of motion
zetaddot = M\(u - G - C*zetadot);

S = zeros(16,1);
S(1)=xdot;
S(2)=ydot;
S(3)=zdot;
S(4)=zetaddot(1);
S(5)=zetaddot(2);
S(6)=zetaddot(3);
S(7)=psidot;
S(8)=thetadot;
S(9)=phidot;
S(10)=zetaddot(4);
S(11)=zetaddot(5);
S(12)=zetaddot(6);
S(13)=q1dot;
S(14)=q2dot;
S(15)=zetaddot(7);
S(16)=zetaddot(8);

end